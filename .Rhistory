dgamma(0,1,1)
dgamma(-1,1,1)
d_zero_alternative <- function(x, a = 2, shape = 15, rate = 7){
1*(abs(x)-a > 0) * dgamma(abs(x)-a, shape, rate)
}
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
r_zero_alternative <- function(N, a = 2, shape = 15, rate = 7){
(-1)^rbinom(N, 1, .5) * (a + rgamma(N, shape, rate))
}
d_zero_alternative <- function(x, a = 2, shape = 15, rate = 7){
1*(abs(x)-a > 0) * dgamma(abs(x)-a, shape, rate)
}
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3)
d_zero_alternative <- function(x, a = 2, shape = 15, rate = 7){
1*(abs(x)-a > 0) * dgamma(abs(x)-a, shape, rate)/2
}
curve(d_zero_alternative, add = TRUE, lwd = 3)
r_zero_alternative <- function(N, a = 2, shape = 15, rate = 7){
(-1)^rbinom(N, 1, .5) * (a + rgamma(N, shape, rate))
}
d_zero_alternative <- function(x, a = 2, shape = 15, rate = 7){
1*(abs(x)-a > 0) * dgamma(abs(x)-a, shape, rate)/2
}
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3)
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#121212")
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#121212")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#ababab")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#acabab")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#acacac")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#bcbcbc")
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#bcbcbc")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#190778")
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#19077810")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#19077830")
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#19077860")
r_zero_alternative <- function(N, a = 2, shape = 15, rate = 7){
(-1)^rbinom(N, 1, .5) * (a + rgamma(N, shape, rate))
}
d_zero_alternative <- function(x, a = 2, shape = 15, rate = 7){
1*(abs(x)-a > 0) * dgamma(abs(x)-a, shape, rate)/2
}
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*2, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#19077860")
N <- 1e5
g <- rbinom(N,1,.9)
N <- 1e5
g <- rbinom(N,1,.9)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N)
z %>% hist(breaks = 100)
N <- 1e5
g <- rbinom(N,1,.9)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,2,7)
z %>% hist(breaks = 100)
N <- 1e5
g <- rbinom(N,1,.9)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,2,5)
z %>% hist(breaks = 100)
N <- 1e5
g <- rbinom(N,1,.9)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,2,4)
z %>% hist(breaks = 100)
r_zero_alternative(N,2,4) %>% hist
r_zero_alternative(N,2,4) %>% hist(breaks = 100)
pnorm(1)-pnorm(-1)
r_zero_alternative(N,1,4) %>% hist(breaks = 100)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,1,4)
z %>% hist(breaks = 100)
r_zero_alternative(N,1,4) %>% hist(breaks = 100)
r_zero_alternative(N,1,4,4) %>% hist(breaks = 100)
r_zero_alternative(N,1,7,4) %>% hist(breaks = 100)
r_zero_alternative(N,1,1,4) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,4) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,2) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,1) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,10) %>% hist(breaks = 100)
r_zero_alternative(N,1,3,10) %>% hist(breaks = 100)
r_zero_alternative(N,1,3,5) %>% hist(breaks = 100)
r_zero_alternative(N,1,3,5) %>% hist(breaks = 100)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,1,3,5)
z %>% hist(breaks = 100)
r_zero_alternative(N,1,3,5) %>% hist(breaks = 100)
?rgamma
3/5
3*(1/5^2)
r_zero_alternative(N,3/5,1) %>% hist(breaks = 100)
r_zero_alternative(N,3/5,.5) %>% hist(breaks = 100)
r_zero_alternative(N,3,.5) %>% hist(breaks = 100)
r_zero_alternative(N,0,3/5,.5) %>% hist(breaks = 100)
r_zero_alternative(N,0,1,.5) %>% hist(breaks = 100)
r_zero_alternative(N,0,1,.75) %>% hist(breaks = 100)
r_zero_alternative(N,0,1,.85) %>% hist(breaks = 100)
r_zero_alternative(N,0,1,.95) %>% hist(breaks = 100)
r_zero_alternative(N,0,1,.99) %>% hist(breaks = 100)
r_zero_alternative(N,0,2,.99) %>% hist(breaks = 100)
r_zero_alternative(1,0,2,.99) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,.99) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,1) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,2) %>% hist(breaks = 100)
r_zero_alternative(N,1,2,3) %>% hist(breaks = 100)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,1,2,3)
z %>% hist(breaks = 100)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.8,2,3)
z %>% hist(breaks = 100)
qnorm(.7)-qnorm(-.7)
pnorm(.7)-pnorm(-.7)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.7,2,3)
z %>% hist(breaks = 100)
r_zero_alternative(N,1,2,3) %>% hist(breaks = 100)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.7,2,3)
z %>% hist(breaks = 100)
r_zero_alternative(N,1,2,3) %>% hist(breaks = 100)
pnorm(.65)-pnorm(-.65)
qnorm(.75)
pnorm(.67)-pnorm(-.67)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.67,2,3)
z %>% hist(breaks = 100)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.7,2,3)
z %>% hist(breaks = 100)
N <- 1e5
g <- rbinom(N,1,.95)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.7,2,3)
z %>% hist(breaks = 100)
r_zero_alternative <- function(N, a = .7, shape = 2, rate = 3){
(-1)^rbinom(N, 1, .5) * (a + rgamma(N, shape, rate))
}
d_zero_alternative <- function(x, a = .7, shape = 2, rate = 3){
1*(abs(x)-a > 0) * dgamma(abs(x)-a, shape, rate)/2
}
r_zero_alternative(1e5) %>% hist(breaks = 100, ylab = "", main = "", freq = FALSE)
abline(v = c(-1,1)*.7, col = "grey")
box()
curve(d_zero_alternative, add = TRUE, lwd = 3, col = "#19077860")
N <- 1e5
g <- rbinom(N,1,.95)
z <- g*rnorm(N) + (1-g)*r_zero_alternative(N,.7,2,3)
z %>% hist(breaks = 100)
box()
z %>% hist(breaks = 100, main = "", ylab = "")
box()
pnorm(.7)-pnorm(-.7)
qnorm(0.75)
pnorm(.674)-pnorm(-.674)
estimate_pi <- function(z, a){
out <- rep(NA, length(a))
for(i in 1:length(a)){
out[i] <- mean(abs(z) < a) / (pnorm(a) - pnorm(-a))
}
out
}
as <- c(.1, .2, .3, .4, .5, .6, .7)
pis <- estimate_pi(zs, as)
warnings()
estimate_pi <- function(z, a){
out <- rep(NA, length(a))
for(i in 1:length(a)){
out[i] <- mean(abs(z) < a[i]) / (pnorm(a[i]) - pnorm(-a[i]))
}
out
}
as <- c(.1, .2, .3, .4, .5, .6, .7)
pis <- estimate_pi(zs, as)
pis
plot(as, pis)
as <- c(.1, .2, .3, .4, .5, .6, .7, .8, .9)
pis <- estimate_pi(zs, as)
plot(as, pis)
plot(as, pis, ylab = "", xlab = "")
title(main = "Estimates of π", xlab = "a")
plot(as, pis, ylab = "", xlab = "")
title(main = "Estimates of π as a function of a", xlab = "a")
z
estimate_pi <- function(z, a){
out <- rep(NA, length(a))
for(i in 1:length(a)){ out[i] <- mean(abs(z) < a[i]) / (pnorm(a[i]) - pnorm(-a[i])) }
out
}
as <- c(.1, .2, .3, .4, .5, .6, .7, .8, .9)
pi_hat <- estimate_pi(z, as)
plot(as, pi_hat)
plot(as, pi_hat, type = "b")
plot(as, pi_hat, type = "b", xlab = "a", ylab = "", main = "Estimated pi in simulated data")
abline(v = .7, col = "#ffffff80")
as <- c(.1, .2, .3, .4, .5, .6, .7, .8, .9)
pi_hat <- estimate_pi(z, as)
plot(as, pi_hat, type = "b", xlab = "a", ylab = "", main = "Estimated pi in simulated data")
abline(v = .7, col = "#ffffff80")
abline(v = .7, col = "#fff")
abline(v = .7, col = "#ffffff")
abline(v = .7, col = "#000000")
abline(v = .7, col = "#00000080")
plot(as, pi_hat, type = "b", xlab = "a", ylab = "", main = "Estimated pi in simulated data")
abline(v = .7, col = "#00000080")
par(mar = c(2,2,4,2))
title(main = "Estimated pi in simulated data", line = 3)
par(mar = c(2,2,4,2))
plot(as, pi_hat, type = "b", xlab = "a", ylab = "")
title(main = "Estimated pi in simulated data", line = 3)
abline(v = .7, col = "#00000080")
axis(3,.7,"True a")
par(mar = c(2,2,4,4))
plot(as, pi_hat, type = "b", xlab = "a", ylab = "")
title(main = "Estimated pi in simulated data", line = 3)
abline(v = .7, col = "#00000080")
par(mar = c(2,2,4,4))
plot(as, pi_hat, type = "b", xlab = "a", ylab = "")
title(main = "Estimated π in simulated data", line = 3)
abline(v = .7, col = "#00000080")
axis(3,.7,"True a")
axis(4,.95,"True π")
par(mar = c(2,2,4,4))
plot(as, pi_hat, type = "b", xlab = "a", ylab = "", ylim = c(.94,.96))
title(main = "Estimated π in simulated data", line = 3)
abline(v = .7, col = "#00000080")
axis(3,.7,"True a")
axis(4,.95,"True π")
abline(h = 0.95, col = "#00000080")
pis <- estimate_pi(zs, as)
plot(as, pis, ylab = "", xlab = "")
title(main = "Estimates of π as a function of a", xlab = "a")
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(a), "True a?")
axis(3,median(as), "True a?")
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?",tick = FALSE)
axis(4,mean(par$usr[3:4]), "True π?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
estimate_pi(zs, a = .75)
estimate_pi(zs, a = .751)
estimate_pi(zs, a = .77)
estimate_pi(zs, a = .78)
estimate_pi(zs, a = .79)
estimate_pi(zs, a = .78)
median(abs(zs))
estimate_pi(zs, a = .78)
book2 <- estimate_pi(zs, a = .77)
book2
book2 <- estimate_pi(zs, a = .78)
book2
points(.75, book1, col = "red", pch = 2)
book1 <- estimate_pi(zs, a = .75)
book2 <- estimate_pi(zs, a = .78)
points(.75, book1, col = "red", pch = 2)
points(.75, book1, col = "red", cex = 2)
points(.78, book2, col = "blue", cex = 2)
text(.75, book1, "a = .75", pos = 2)
text(.78, book2, "Book π", pos = 2)
text(.78, book2, "Book π", pos = 4)
text(.78, book2, "Book π", pos = 4, outer = TRUE)
text(.78, book2, "Book π", pos = 4, xpd = FALSE)
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
book1 <- estimate_pi(zs, a = .75)
book2 <- estimate_pi(zs, a = .78)
points(.75, book1, col = "red", cex = 2)
text(.75, book1, "a = .75", pos = 2)
points(.78, book2, col = "blue", cex = 2)
text(.78, book2, "Book π", pos = 4, xpd = FALSE)
text(.78, book2, "π", pos = 4, xpd = FALSE)
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
book1 <- estimate_pi(zs, a = .75)
book2 <- estimate_pi(zs, a = .78)
points(.75, book1, col = "red", cex = 2)
text(.75, book1, "a = .75", pos = 2)
points(.78, book2, col = "blue", cex = 2)
text(.78, book2, "π hat", pos = 4, xpd = FALSE)
legend("topleft", c("The value of a in the book", "The value of π in the book"), col = c("red","blue"), cex = 2)
legend("topleft", c("The value of a in the book", "The value of π in the book"), col = c("red","blue"))
legend("topleft", c("The value of a in the book", "The value of π in the book"), col = c("red","blue"), pch = 16)
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
book1 <- estimate_pi(zs, a = .75)
book2 <- estimate_pi(zs, a = .78)
points(.75, book1, col = "red", cex = 2)
text(.75, book1, "a = .75", pos = 2)
points(.78, book2, col = "blue", cex = 2)
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
book1 <- estimate_pi(zs, a = .75)
book2 <- estimate_pi(zs, a = .78)
points(.75, book1, col = "red", cex = 2)
points(.78, book2, col = "blue", cex = 2)
legend("topleft", c("The value of a in the book", "The value of π in the book"), col = c("red","blue"), pch = 16, bty = "n")
con <- "http://statweb.stanford.edu/~ckirby/brad/LSI/datasets-and-programs/data/DTIdata.RData" %>% url
load(con); close(con)
DTIdata %>% dim
pis <- estimate_pi(DTIdata[,4], as)
plot(as, pis, ylab = "", xlab = "", type = "b")
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
book1 <- estimate_pi(DTIdata[,4], 0.75)
book1
estimate_pi(DTIdata[,4], 0.78)
estimate_pi(DTIdata[,4], 0.79)
estimate_pi(DTIdata[,4], 0.8)
estimate_pi(DTIdata[,4], 0.9)
estimate_pi(DTIdata[,4], 0.95)
tmp <- estimate_pi(DTIdata[,4], seq(0.7,0.8,by = 0.05))
plot(seq(0.7,0.8,by = 0.05), tmp)
xxx <- seq(0.7,0.8,by = 0.005)
tmp <- estimate_pi(DTIdata[,4], xxx)
plot(xxx, tmp)
max(tmp)
pis <- estimate_pi(DTIdata[,4], as)
as <- seq(0.2, 0.8,by = 0.005)
pis <- estimate_pi(DTIdata[,4], as)
plot(as, pis, ylab = "", xlab = "", type = "b")
plot(as, pis, ylab = "", xlab = "", type = "b", ylim = c(min(pis, 0.94)))
plot(as, pis, ylab = "", xlab = "", type = "b", ylim = c(min(pis), 0.94))
title(main = "Estimates of π as a function of a", xlab = "a")
axis(3,median(as), "True a?", tick = FALSE)
axis(4,mean(par()$usr[3:4]), "True π?", tick = FALSE)
book1 <- estimate_pi(DTIdata[,4], 0.75)
points(.75, book1, col = "red", cex = 2)
abline(h = 0.935, col = "blue")
legend("topleft", c("The value of a in the book", "The value of π in the book"), col = c("red","blue"), pch = 16, bty = "n")
points(.75, book1, col = "red", cex = 2)
abline(h = 0.935, col = "blue")
legend("topleft", c("The value of a in the book", "The value of π in the book?"), col = c("red","blue"), pch = 16, bty = "n")
ws <- cut(zs,breaks = 100)
ws
cs <- table(ws)
cs
plot(cs)
hist(zs, breaks = 100)
plot(cs, add = TRUE)
hist(zs, breaks = 100)
lines(cs, add = TRUE)
lines(cs)
lines(cs, col = "blue")
hist(zs, breaks = 100, col = "red")
lines(cs, col = "blue")
cs
points(cs, col = "blue")
?cut
ws <- cut(zs,breaks = 100)
ws
str(wd)
str(ws)
labs <- levels(ws)
cbind(lower = as.numeric( sub("\\((.+),.*", "\\1", labs) ),
upper = as.numeric( sub("[^,]*,([^]]*)\\]", "\\1", labs) ))
ws <- cut(zs,breaks = 100)
labs <- levels(ws)
lo <- labs %>% sub("\\((.+),.*", "\\1", .) %>% as.numeric
up <- labs %>% sub("[^,]*,([^]]*)\\]", "\\1", .) %>% as.numeric
mp <- .5*lo + .5*up
mp
cs <- table(ws)
hist(zs, breaks = 100, col = "red")
points(mp, cs, col = "blue")
hist(diff(mp))
ws <- cut(zs, breaks = seq(min(zs - .1), max(zs + .1), length = 100))
labs <- levels(ws)
lo <- labs %>% sub("\\((.+),.*", "\\1", .) %>% as.numeric
up <- labs %>% sub("[^,]*,([^]]*)\\]", "\\1", .) %>% as.numeric
mp <- .5*lo + .5*up
cs <- table(ws)
hist(zs, breaks = 100, col = "red")
points(mp, cs, col = "blue")
hist(diff(mp))
hist(zs, breaks = 100, col = "red")
points(mp, cs, col = "blue")
glm(cs ~ poly(mp, degree = 3, raw = TRUE), family = poisson)
ws <- cut(zs, breaks = seq(-4.5, 4.5, by = .1))
ws
labs <- levels(ws)
lo <- labs %>% sub("\\((.+),.*", "\\1", .) %>% as.numeric
up <- labs %>% sub("[^,]*,([^]]*)\\]", "\\1", .) %>% as.numeric
mp <- .5*lo + .5*up
mp
cs <- table(ws)
hist(zs, breaks = 90, col = "red")
points(mp, cs, col = "blue")
glm1 <- glm(cs ~ poly(mp, degree = 3, raw = TRUE), family = poisson)
glm1 %>% predict()
glm1 %>% predict(type = "response")
yhat <- glm1 %>% predict(type = "response")
lines(mp, yhat)
hist(zs, breaks = 90, col = "#ad000040")
hist(zs, breaks = 90, col = "#ad000070")
points(mp, cs, col = "blue")
hist(zs, breaks = 90, col = "#ad000070",border = "white")
points(mp, cs, col = "blue")
points(mp, cs, col = "#0E0879")
hist(zs, breaks = 90, col = "#ad000070",border = "white")
points(mp, cs, col = "#0E0879")
glm1 <- glm(cs ~ poly(mp, degree = 3, raw = TRUE), family = poisson)
yhat <- glm1 %>% predict(type = "response")
lines(mp, yhat, col = "purple", lwd = 3)
box()
pz <- ecdf(zs)(zs)
pz
plot(zs, pz)
?poly
?splines
??splines
require(splines)
suppressMessages(require(splines))
help(package = "splines")
lm1 <- lm(pz ~ bs(zs, degree = 3))
head(lm1)
predict(lm1)
lines(zs, predict(lm1))
pz <- ecdf(zs)(zs)
plot(zs, pz, col = "#0E0879")
lm1 <- lm(pz ~ bs(zs, degree = 3))
points(zs, predict(lm1), col = "purple")
?ns
lm1 <- lm(pz ~ ns(zs, 3))
points(zs, predict(lm1), col = "purple")
pz ~ rcs(zs, 4) %>% explicit_rcs(data.frame(pz = pz, zs = zs))
(pz ~ rcs(zs, 4)) %>% explicit_rcs(data.frame(pz = pz, zs = zs))
(pz ~ rcs(zs, 4)) %>% explicit_rcs(data.frame(pz = pz, zs = zs), .)
ef <- (pz ~ rcs(zs, 4)) %>% explicit_rcs(data.frame(pz = pz, zs = zs), .)
#ef <- (pz ~ rcs(zs, 4)) %>% explicit_rcs(data.frame(pz = pz, zs = zs), .)
ef <- pz ~ rcs(zs, parms = c(-1.81, -0.43, 0.42, 1.81))
model.matrix(ef, data = data.frame(pz = pz, zs = zs))
#ef <- (pz ~ rcs(zs, 4)) %>% explicit_rcs(data.frame(pz = pz, zs = zs), .)
ef <- pz ~ rms::rcs(zs, parms = c(-1.81, -0.43, 0.42, 1.81))
model.matrix(ef, data = data.frame(pz = pz, zs = zs))
X <- model.matrix(ef, data = data.frame(pz = pz, zs = zs))
dim(X)
X[,1]
lm1 <- lm(zs ~ X)
points(zs, predict(lm1), col = "purple")
lm1
lm1 <- lm(zs ~ 0 + X)
lm1
points(zs, predict(lm1), col = "purple")
lm1$fitted.values
?loess
l1 <- loess(pz ~ zs)
plot(zs, pz, col = "#0E0879")
names(l1)
points(zs, l1$fitted, col = "purple")
l1 <- loess(pz ~ zs)
points(zs, l1$fitted, col = "purple")
l1 <- loess(log(pz/(1-pz)) ~ zs)
log(pz/(1-pz))
l1 <- loess(log(pz/(1-pz)) ~ zs)
l1 <- loess(log(pz/(1-pz)) ~ zs, na.rm = TRUE)
l1 <- lm(log(pz/(1-pz)) ~ poly(zs, degree = 3))
pz <- ecdf(c(-10, zs, 10))(zs)
log(pz/(1-pz))
plot(zs, pz, col = "#0E0879")
log(pz/(1-pz))
l1 <- lm(log(pz/(1-pz)) ~ poly(zs, degree = 3))
predict(l1)
sigmoid <- function(x) 1/(1+exp(-x))
logodds <- function(x) log(x/(1-x))
sigmoid <- function(x) 1/(1+exp(-x))
l1 <- lm(logodds(pz) ~ poly(zs, degree = 3))
points(zs, sigmoid(l1$fitted), col = "purple")
predict(l1,newdata=data.frame(zs = lo))
predict(l1,newdata=data.frame(zs = lo)) %>% sigmoid
predict(l1,newdata=data.frame(zs = up)) %>% sigmoid
phat <- p_up - p_lo
p_lo <- predict(l1,newdata=data.frame(zs = lo)) %>% sigmoid
p_up <- predict(l1,newdata=data.frame(zs = up)) %>% sigmoid
phat <- p_up - p_lo
phat
hist(zs, breaks = 90, col = "#ad000070",border = "white")
points(mp, cs, col = "#0E0879")
lines(mp, yhat, col = "purple", lwd = 3)
hist(zs, breaks = 90, col = "#ad000070",border = "white")
lines(mp, yhat, col = "purple", lwd = 3)
nhat <- phat * length(zs)
lines(mp, nhat, col = "darkgreen", lwd = 3)
box()
legend("topleft", c("Lindsay's","ECDF"), lwd = 3, col = c("purple","darkgreen"))
hist(zs, breaks = 90, col = "#ad000070",border = "white")
lines(mp, yhat, col = "purple", lwd = 3)
lines(mp, nhat, col = "darkgreen", lwd = 3)
box()
legend("topleft", c("Lindsay's","ECDF"), lwd = 3, col = c("purple","darkgreen"), bty = 'n)
'
)
hist(zs, breaks = 90, col = "#ad000070",border = "white")
lines(mp, yhat, col = "purple", lwd = 3)
lines(mp, nhat, col = "darkgreen", lwd = 3)
box()
legend("topleft", c("Lindsay's","ECDF"), lwd = 3, col = c("purple","darkgreen"), bty = 'n')
